# =========================
# Project / Compose
# =========================
COMPOSE_PROJECT_NAME=ticketing

# =========================
# Postgres (Docker)
# =========================
POSTGRES_IMAGE=postgres:16
POSTGRES_CONTAINER=ticketing-postgres

POSTGRES_USER=app
POSTGRES_PASSWORD=app
POSTGRES_DB=ticketing

# Exposed port on your machine
POSTGRES_PORT=5555

# =========================
# Redis (Docker)
# =========================
REDIS_IMAGE=redis:7
REDIS_CONTAINER=ticketing-redis
REDIS_PORT=6379

# =========================
# Kafka (Docker) - Bitnami (KRaft)
# =========================
KAFKA_IMAGE=apache/kafka:3.9.0
KAFKA_CONTAINER=ticketing-kafka

# Exposed Kafka port on your machine
KAFKA_PORT=9092

# Internal controller port (donâ€™t need to expose)
KAFKA_CONTROLLER_PORT=9093

# What host clients use to connect (your machine)
KAFKA_ADVERTISED_HOST=localhost

# =========================
# App (NestJS)
# =========================
NODE_ENV=development
PORT=3000
API_PREFIX=api
API_VERSION=1
API_DOCS_PATH=docs

JWT_SECRET=change-me
JWT_EXPIRES_IN=1d
PAYMENT_WEBHOOK_SECRET=

# App connection strings (keep explicit; don't rely on interpolation)
DATABASE_URL=postgresql://app:app@localhost:5555/ticketing?schema=public
REDIS_URL=redis://localhost:6379
KAFKA_BROKERS=localhost:9092
OUTBOX_PUBLISH_BATCH_SIZE=100
OUTBOX_PUBLISH_LEASE_SECONDS=30
OUTBOX_PUBLISH_MAX_ATTEMPTS=10
OUTBOX_PUBLISH_MAX_LOOPS=5
ALERT_OUTBOX_FAILURE_RATIO_THRESHOLD=0.1
ALERT_OUTBOX_MIN_SAMPLES=20
ALERT_PAYMENT_WEBHOOK_FAILURE_RATIO_THRESHOLD=0.2
ALERT_PAYMENT_WEBHOOK_MIN_SAMPLES=20
ALERT_PAYMENT_SUCCEEDED_DLQ_THRESHOLD=1
ALERT_PAYMENT_SUCCEEDED_RETRY_THRESHOLD=20
